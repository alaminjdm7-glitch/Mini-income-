<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Earn ‚Äì Final Version</title>

<!-- AD NETWORK -->
<script src="//libtl.com/sdk.js" data-zone="10314131" data-sdk="show_10314131"></script>

<style>
body {margin:0;font-family:Arial,sans-serif;background:#0f0f0f;color:white;scroll-behavior:smooth;}
.container{max-width:420px;margin:auto;padding:20px;}
.card{background:#1c1c1c;padding:15px;border-radius:12px;margin-bottom:15px;}
button{width:100%;padding:12px;background:#ff3c3c;border:none;color:white;border-radius:8px;font-size:16px;margin-top:10px;cursor:pointer;}
input,select{width:100%;padding:10px;margin-top:10px;font-size:16px;border-radius:6px;border:1px solid #333;background:#1c1c1c;color:white;}
.withdraw-history,.task-history{max-height:200px;overflow-y:auto;margin-top:10px;}
.notice{background:#FFFBCC;color:black;padding:10px;border-radius:6px;margin-bottom:10px;}
.nav{position:fixed;bottom:0;left:0;right:0;background:#111;display:flex;justify-content:space-around;padding:12px 0;border-top:1px solid #333;}
.nav div{font-size:16px;font-weight:bold;cursor:pointer;color:#aaa;}
.nav div.active{color:#00ff99;}
</style>
</head>

<body>

<div class="container">

<!-- DASHBOARD -->
<div class="card" id="dashboard">
    <div class="notice">‡¶è‡¶ü‡¶ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶´‡¶ø‡¶∏‡ßá‡¶∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶∏‡¶æ‡¶á‡¶ü‡•§ ‡¶è‡¶ñ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶â‡¶∞‡¶æ‡¶ß‡ßÅ‡¶∞‡¶æ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>
    <p>User: <b id="nameBox">User</b> | ID: <b id="idBox">0</b></p>
    <p>Balance: <b id="balanceBox">0.00</b> BDT</p>
</div>

<!-- TASKS -->
<div class="card" id="tasks">
    <h3>üéØ Tasks</h3>
    <button onclick="joinChannel(0)">üì¢ Join Channel 1 (+5‡ß≥)</button>
    <button onclick="joinChannel(1)">üì¢ Join Channel 2 (+5‡ß≥)</button>
    <button onclick="joinChannel(2)">üì¢ Join Channel 3 (+5‡ß≥)</button>
    <button onclick="viewChannel()">üëÄ View Channel (+1‡ß≥ first time)</button>
    <button onclick="watchAd()">‚ñ∂Ô∏è Watch Ad (+5‡ß≥)</button>
    <p style="margin-top:10px">Ads Watched: <b id="adsWatched">0 / 30</b></p>
    <button onclick="loadTaskHistory()">üìú Task History</button>
    <div id="taskHistoryList" class="task-history"></div>
</div>

<!-- WITHDRAW -->
<div class="card" id="withdraw">
    <h3>Withdraw</h3>
    <form id="withdrawForm" onsubmit="event.preventDefault(); sendWithdraw();">
        <input type="number" id="amount" placeholder="Amount">
        <input type="text" id="number" placeholder="Bkash/Nagad Number">
        <select id="method">
            <option>Bkash</option>
            <option>Nagad</option>
            <option>Rocket</option>
        </select>
        <button type="submit" style="background:#00cc66;">Withdraw</button>
    </form>
    <button onclick="loadHistory()">Load Withdraw History</button>
    <div id="historyList" class="withdraw-history"></div>
</div>

<!-- PROFILE -->
<div class="card" id="profile">
    <h3>üë§ Profile</h3>
    <p>Name: <b id="nameBoxProfile"></b></p>
    <p>User ID: <b id="idBoxProfile"></b></p>
    <p>Balance: <b id="profileBalance"></b> BDT</p>
    <p>Ads Watched: <b id="profileAdsWatched"></b></p>
</div>

</div>

<!-- NAVIGATION -->
<div class="nav">
    <div class="active" data-page="dashboard" onclick="scrollToSection('dashboard', this)">Home</div>
    <div data-page="tasks" onclick="scrollToSection('tasks', this)">Tasks</div>
    <div data-page="withdraw" onclick="scrollToSection('withdraw', this)">Withdraw</div>
    <div data-page="profile" onclick="scrollToSection('profile', this)">Profile</div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
const tg = window.Telegram.WebApp;
tg.expand();

const BOT_TOKEN = "YOUR_BOT_TOKEN";
const ADMIN_ID = "YOUR_ADMIN_ID";

// User Info
let user = tg?.initDataUnsafe?.user || {};
let USER_NAME = user?.first_name || "Guest";
let USER_ID = user?.id || Date.now();

// Tasks
const CHANNEL_JOIN_REWARD = 5;
const CHANNEL_VIEW_REWARD = 1;
const AD_REWARD = 5;
const MAX_DAILY_ADS = 30;
const MAX_WITHDRAW = 500;
const CHANNEL_JOIN_LINKS = ["https://t.me/DevleparX_Namid","https://t.me/GmailMarketingB","https://t.me/BDIncomep"];
const CHANNEL_VIEW_LINK = "https://t.me/GmailMarketing_99bot";

// User Data
let balance = JSON.parse(localStorage.getItem("balance_" + USER_ID) || "0");
let adsWatched = JSON.parse(localStorage.getItem("adsWatched_" + USER_ID) || "0");
let withdrawHistory = JSON.parse(localStorage.getItem("history_" + USER_ID) || "[]");
let taskHistory = JSON.parse(localStorage.getItem("task_history_" + USER_ID) || "[]");

// Update UI
function updateUI(){
    document.getElementById("nameBox").innerText = USER_NAME;
    document.getElementById("idBox").innerText = USER_ID;
    document.getElementById("balanceBox").innerText = balance.toFixed(2);
    document.getElementById("adsWatched").innerText = adsWatched + " / " + MAX_DAILY_ADS;
    document.getElementById("nameBoxProfile").innerText = USER_NAME;
    document.getElementById("idBoxProfile").innerText = USER_ID;
    document.getElementById("profileBalance").innerText = balance.toFixed(2);
    document.getElementById("profileAdsWatched").innerText = adsWatched;
}

updateUI();

// NAVIGATION
function scrollToSection(section, btn){
    document.querySelectorAll(".nav div").forEach(n => n.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(section).scrollIntoView({behavior:"smooth"});
}

// AD TASK
function watchAd(){
    if(adsWatched >= MAX_DAILY_ADS){alert("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");return;}
    if(typeof show_10314131 !== "function"){alert("Ad load ‡¶π‡ßü‡¶®‡¶ø");return;}
    show_10314131("pop").then(()=>{
        adsWatched++;
        balance += AD_REWARD;
        localStorage.setItem("adsWatched_" + USER_ID, adsWatched);
        localStorage.setItem("balance_" + USER_ID, balance);
        taskHistory.push({type:"Ad Watch", reward:AD_REWARD, date:new Date().toLocaleString()});
        localStorage.setItem("task_history_" + USER_ID, JSON.stringify(taskHistory));
        updateUI();
        alert("‚úÖ ‡¶Ü‡¶™‡¶®‡¶ø " + AD_REWARD + " ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®");
    });
}

// CHANNEL JOIN
function joinChannel(index){
    let joinedKey = "joined_channel_" + USER_ID + "_" + index;
    if(localStorage.getItem(joinedKey)){alert("‚úÖ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶á ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ú‡ßü‡ßá‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®");return;}
    window.open(CHANNEL_JOIN_LINKS[index], "_blank");
    setTimeout(()=>{
        localStorage.setItem(joinedKey,true);
        balance += CHANNEL_JOIN_REWARD;
        localStorage.setItem("balance_" + USER_ID, balance);
        taskHistory.push({type:"Channel Join", reward:CHANNEL_JOIN_REWARD, date:new Date().toLocaleString(), channel:CHANNEL_JOIN_LINKS[index]});
        localStorage.setItem("task_history_" + USER_ID, JSON.stringify(taskHistory));
        updateUI();
        alert("üéâ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ú‡ßü‡ßá‡¶® ‡¶∏‡¶´‡¶≤!\n‡¶Ü‡¶™‡¶®‡¶ø " + CHANNEL_JOIN_REWARD + " ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®");
    },4000);
}

// CHANNEL VIEW
function viewChannel(){
    let firstViewKey = "first_view_" + USER_ID;
    if(!localStorage.getItem(firstViewKey)){
        localStorage.setItem(firstViewKey,true);
        window.open(CHANNEL_VIEW_LINK,"_blank");
        balance += CHANNEL_VIEW_REWARD;
        localStorage.setItem("balance_" + USER_ID, balance);
        taskHistory.push({type:"Channel View", reward:CHANNEL_VIEW_REWARD, date:new Date().toLocaleString(), first:true});
        localStorage.setItem("task_history_" + USER_ID, JSON.stringify(taskHistory));
        updateUI();
        alert("üëÄ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶â ‡¶∏‡¶´‡¶≤!\n‡¶Ü‡¶™‡¶®‡¶ø " + CHANNEL_VIEW_REWARD + " ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®");
    } else {
        watchAd();
    }
}

// WITHDRAW
async function sendWithdraw(){
    let amount = Number(document.getElementById("amount").value);
    let number = document.getElementById("number").value;
    let method = document.getElementById("method").value;

    if(balance < MAX_WITHDRAW){alert("‚ùå ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø");return;}
    if(!amount || !number){alert("‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®");return;}
    if(amount < MAX_WITHDRAW){alert("‚ùå ‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ");return;}
    if(amount > balance){alert("Balance is not enough!");return;}

    balance -= amount;
    localStorage.setItem("balance_" + USER_ID, balance);
    updateUI();

    let now = new Date();
    withdrawHistory.push({amount, number, method, date: now.toLocaleDateString(), time: now.toLocaleTimeString()});
    localStorage.setItem("history_" + USER_ID, JSON.stringify(withdrawHistory));
    loadHistory();

    let msg = `üì¢ New Withdraw Request
üë§ Name: ${USER_NAME}
üÜî User ID: ${USER_ID}
üíµ Amount: ‡ß≥${amount}
üì± Number: ${number}
üí≥ Method: ${method}`;

    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({chat_id:ADMIN_ID, text:msg})
    });

    alert("‚úÖ Withdraw Request Submitted!");
    document.getElementById("withdrawForm").reset();
}

// LOAD HISTORY
function loadHistory(){
    const box = document.getElementById("historyList");
    box.innerHTML = "";
    if(withdrawHistory.length===0){box.innerHTML="<p>No withdraw history yet.</p>";return;}
    withdrawHistory.slice().reverse().forEach(w=>{
        box.innerHTML += `<div class='card'>
            <b>Amount:</b> ‡ß≥${w.amount}<br>
            <b>Number:</b> ${w.number}<br>
            <b>Method:</b> ${w.method}<br>
            <b>Date:</b> ${w.date} ${w.time}
        </div>`;
    });
}

// TASK HISTORY
function loadTaskHistory(){
    const box = document.getElementById("taskHistoryList");
    box.innerHTML = "";
    if(taskHistory.length===0){box.innerHTML="<p>No task history yet.</p>";return;}
    taskHistory.slice().reverse().forEach(t=>{
        box.innerHTML += `<div class='card'>
            <b>Task:</b> ${t.type}<br>
            <b>Reward:</b> ‡ß≥${t.reward}<br>
            ${t.channel ? "<b>Channel:</b> "+t.channel+"<br>":""}
            <b>Date:</b> ${t.date}
        </div>`;
    });
}

</script>

</body>
</html>
