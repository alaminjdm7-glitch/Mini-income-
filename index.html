<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Earn</title>

<style>
    body {
        background: #f2f2f7;
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
    }
    .container {
        max-width: 420px;
        margin: auto;
        padding: 20px;
    }
    .card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        margin-bottom: 15px;
    }
    button {
        width: 100%;
        padding: 12px;
        background: #4E73DF;
        border: none;
        color: white;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
    }
    .nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        display: flex;
        justify-content: space-around;
        padding: 12px 0;
        border-top: 1px solid #ccc;
    }
    .nav div {
        font-size: 18px;
        font-weight: bold;
    }
</style>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const BOT_TOKEN = "8547106742:AAGzYH6K6dDFR3lB4RdDcCRpZ_VBmlPCkuw";
    const ADMIN_ID = "8188773875";

    let user = tg?.initDataUnsafe?.user;

    let USER_NAME = user?.first_name || "Unknown";
    let USER_USERNAME = user?.username || "NoUsername";
    let USER_ID = user?.id || "NoID";

    // Withdraw History Save
    function saveHistory(amount, number, method) {
        let old = JSON.parse(localStorage.getItem("history") || "[]");
        old.push({
            amount,
            number,
            method,
            date: new Date().toLocaleString()
        });
        localStorage.setItem("history", JSON.stringify(old));
        alert("Withdraw History Saved!");
    }

    // Send to Admin Bot
    async function sendWithdraw() {
        let amount = document.getElementById("amount").value;
        let number = document.getElementById("number").value;
        let method = document.getElementById("method").value;

        if (!amount || !number) {
            alert("à¦¸à¦¬ à¦«à¦¿à¦²à§à¦¡ à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨");
            return;
        }

        let text = 
`ðŸ“¢ *New Withdraw Request*
ðŸ‘¤ Name: ${USER_NAME}
ðŸ”— Username: @${USER_USERNAME}
ðŸ†” User ID: ${USER_ID}

ðŸ’µ Amount: à§³${amount}
ðŸ“± Number: ${number}
ðŸ’³ Method: ${method}`;

        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                chat_id: ADMIN_ID,
                text: text,
                parse_mode: "Markdown"
            })
        });

        saveHistory(amount, number, method);
        alert("Withdraw Request Sent!");
    }

    function loadHistory() {
        let data = JSON.parse(localStorage.getItem("history") || "[]");
        let box = document.getElementById("historyList");
        box.innerHTML = "";

        data.forEach(x => {
            box.innerHTML += `
                <div class='card'>
                    <b>Amount:</b> à§³${x.amount}<br>
                    <b>Number:</b> ${x.number}<br>
                    <b>Method:</b> ${x.method}<br>
                    <b>Date:</b> ${x.date}<br>
                </div>
            `;
        });
    }

</script>
</head>

<body>
<div class="container">

    <div class="card">
        <h2>Welcome, <span id="nameBox"></span></h2>
        <script>document.getElementById("nameBox").innerText = USER_NAME;</script>
        <p>User ID: <b id="idBox"></b></p>
        <script>document.getElementById("idBox").innerText = USER_ID;</script>
    </div>

    <div class="card">
        <h3>Withdraw</h3>
        <input id="amount" type="number" placeholder="Amount" style="width:100%;padding:10px;">
        <input id="number" type="text" placeholder="Bkash/Nagad Number" style="width:100%;padding:10px;margin-top:10px;">

        <select id="method" style="width:100%;padding:10px;margin-top:10px;">
            <option>Bkash</option>
            <option>Nagad</option>
            <option>Rocket</option>
        </select>

        <button onclick="sendWithdraw()" style="margin-top:15px;">Withdraw</button>
    </div>

    <div class="card">
        <h3>Withdraw History</h3>
        <button onclick="loadHistory()">Load History</button>
        <div id="historyList" style="margin-top:10px;"></div>
    </div>

</div>

<div class="nav">
    <div>Home</div>
    <div>Tasks</div>
    <div>Withdraw</div>
    <div>Profile</div>
</div>

</body>
</html>
